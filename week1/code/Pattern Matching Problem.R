############ Problem ############################################################
# Pattern Matching Problem: Find all occurrences of a pattern in a string.
# Input: Two strings, Pattern and Genome.
# Output: All starting positions where Pattern appears as a substring of Genome.
# NOTE:  0-based indexing
#################################################################################

library("stringr")

patternMatch <- function(string, pattern, indexBase=1){

  lenPattern <- str_length(pattern)
  lenStr <- str_length(string)
  
  if(lenPattern > lenStr)
   return(c())
  
  matches <- sapply(1:(lenStr-lenPattern+1), function(start){
    end <- start + lenPattern - 1
    curStr <- substr(string, start, end)
    return(curStr == pattern)
  })
  
  matchIndexes <- which(matches==T)
  if(indexBase != 1)
    matchIndexes <- matchIndexes - 1 + indexBase
  
  return(matchIndexes)
}

pattern <- "GGTCCAG"
string <- "ACGGTCCAGGTCCAACGGTCCAGGTCCACGAGGTCCAGGTCCAGGTCCAGGTCCAGGTCCAATGTACTGACCGCACGGGTCCAGGGTCCAGAGGTCCATTAAGGTCCATGGTCCAGGTCCAGGGTCCACTAGGTCCATGCGGTCCATGGGAAAGAACGTATGGTCCATTGGTCCAGCGGTCCAGGTCCAGGGAGGTCCACTTTGGTCCATGCACATGGTCCAGGTGGTCCATGGTCCAGTTGGTCCATGTCGGGTCCATCAGGTCCATCAGTGGTCCAGGGTCCAGGTCCAGGTCCACTGGAGGTCCAGGTCCAGGTCCACGGTCCAGGTCCAGACGGTCCACGGTCCACGGTCCAAGCGGTCCAAAGTTCGGTCCACGGTCCAACGTAGGTCCAGCAGAGGTCCAGGGTCCACAGGTCCACCGGTCCAAGGTCCATAGGTCCAGGTCCAGGTCCAAGGTCCAGTTCGGTCCAGCGGTCCAGGGTCCAGCGGTCCAGGTCCAGGTCCATGGTTTGGTCCATGGCGGGGTCCAGGTCCAGGTCCATAAAGGTCCAACCCGGGTCCAGGTCCATGCGGTCCATGGTCCATGGTCCACCCAGGTCCACGGTGGTCCAGCCCCGGTCCCGAGGTCCAACCAAGGTCCAACTGGTCCAGGGGTCCATGGTCCAGGTCCACCTTGGTCCAGGTCCACATGCTCATCGAGGTCCAAGGATGGTCCACCAGCAAAGGTCCATGGTCCAGGTCCAGGTCCATTAGGGTCCAGAGGTCCATGGTCCAGGTCCACGCAGGTCCATTCGGCGGGTCCAGAGGTCCAGTAGGAGCAAAGGTCCAGGTCCAAACGGGTCCATCTGGTCCACCCCCGGTCCACCGTGGTCCACAGGGTCCACGGTCCAGGTCCACCAGGGTCCAGGTCCACGGTCCAGGGTCCAGTCGGTCCAGGTCCAGTTACGGTCCAGGTCCAGAGGTCCAGGTCCAGCGACCAGGTCCAGGATGGTCCATACTCGGGTCCATAGAGGGTCCAAAGGCACACAATTGGTGGTCCATGGTCCAAGGGTCCAACGGTCCATGCGGTCCAGCTCGGGGTCCAGGTCCATCGGTCCAGGGTCCATAGGTCCACTGTAGGGTCCATGGTCCAGGTCCACGGTCCAGGAGGTCCACCATGGTCCACGGGTCCAGGTCCAGGTCCATTGGGTCCAGCACGGTCCAATGGGTCCAGGGTCCACGGGTCCAAGTCAAAGGTCCATTGGGTCCAGGTCCAGGTCCAATGGCGAGGTCCAGCAGCCGGTCCACGGTCCACCGTCAGGTCCAGGTCCACGTGGGGTCCAGGTCCAGATTAGCCGGTCCAGGTCCAATGGTCCAGGTCCAGCGTCTTGAGGTCCACGGTCCACGATTGATTGGTCCACGGTCCAGAGGAACAGGTCCAGGTCCATGGTCCATGGGTCCAGCTAACCACGGTCCAGGTCCACAACGTAGGTCCAACCGGGGGGTCCATGTAAGGTCCAGTGGTCCAACGGGTCCAGGTCCAAGTGTGGTCCAATAAACACCCAGCTTGCGGTCCATCACGGGTCCAAGGTCCATGTGCTGGTCCATAGGTCCATCCGGTCCACTCCTCGCCGGTCCAGAGACGGTCCAGGTCCAGGTCCACTAGGTCCAAGGTCCAGGTCCACACCGGTCCAGGGTCCAAATGGTCCAGGTCCAGGTCCAAGGGGTCCATAGGAGCACTGTCAGTGATTCTAGGCGGGGTCCAGCGATTAAGGTCCAGACCTAAGGTCCAAGGTCCACGGTCCACAGGTCCAGATTATACAAGTTCCAAAGGTCCAGGTCCACAAATCAACACGTGGTCCAGTGGGTCCAAGAGGGTCCATGGTCCAGGTCCACGAGGTCCAAGGTCCACGAGGTCCAGGTCCAGGTCCAGGTCCATAATCGGTCCAGGTCCAGGGTCCAATGGTCCAGGTCCACTAGCGTTGGTCCATGGGAATTATGGTCCACGGTCCAGATCGGTCCACGGTCCAACGGTCTAACCTAGCGAAGGTCCAGGGCCGGTCCACGGTCCATGGTCCAGGTCCAGGGTCCAGGTCCAGGGTCCAGCGACGGTCCAGGGTCCAGGTCCAGGGTCCAAAGCGGTCCAGGTCCACGGTCCACGGTCCAGGTCCAATCGGTCCACTATAGGGTCCAGGTCCATTGACCATGGTCCAATAACGGTCCAATCCCTCGGTCCAGTGGGTCCATAGGTCCATAAGGTCCAGGGTCCAGCCACGGAGCACGGTCCATCGGATCATGGTCCAGGTCCATTGGGGGTCCAGGGTCCAAGGTCCAAGCGGTCCAGGTCCAGGTCCAGGTCCACGGTCCACGAAGGTCCAGGGTCCAGGTCCAGGTCCAGGTCCATCGGCCCACCAGGGTCCATTCCGGTCCAGGTCCATGGTCCAGGTCCATAGTTAGGTCCATGACGGGTCCAAGGTCCACCCGGGACGTGGTCCAGGGTCCAATGGTCCAGGTCCAAGGTCCGGGGTCCAAACCGAAATACGACCGGTCCATGGTCCAGGTCCAGGTCCAGGTCCAGATGGTCCAACGGTCCAGGTCCACGGTCCAGGGTCCAGGTCCAGTGAGGGGTCCAACTACAAGGTCCACAGGTCCATAGGTCCAGGGGTCCAGGTCCATGCAGATCGGTCCATGGTCCACAAGGTCCAGTCGCTTGACGGTCCATTGGGTCCAGCAAGGGTCCAGGGTCCATAATGGTCCACGGTCCAAAGGGTCCAGAGCGGTCCAAAGGGTCCAGAAGGTCCAGGTCCATGGTCCAGTCGGTCCATCGGTCCAGTGGTCCAACGGTCCAACCGGTCCAGGTCCAGGGTCCACTGGTCCATGGGTCCACGGAGGGTCCAGGTCCAGGGGTCCAGTGGTCCAATCGGGATAGGGTCCAGGTCCACGGTCCATTGGTCCACGGTCCAACTGGGTGTCGGTCCAGGTCCACCGGTCCATGTGGTCCACAACGGTCCAGGTCCAGGTGGTTGGGGTCCAGGTCCACGGTCCAGGTCCAGGTCCAAGGTCCAATTCTGGTCCAATTCTGGTCCAGGTCCAGCGGTCCAGGTCCAGGTCCAGGTCCAGCCGGGTCCAGGGTCCATCGGTCCACGGTCCAGTTAGTGGTCCACAGGACGGTCCATTACGGTCCAAATGACGGGTAACGGGTCCAGGTCCAGGTCCAAGAACGTTGGTCCAGGTCCACGGTCCACGGTCCAGGTCCATCAGGTCCATTGCCAGCGGTCCACGGTACAGTCAAGGGTCCAGTTCGGTCCACGGTCCAGCGGTCCATGGTCCAGGGTCCATGGTCCAAGTGGCGGTCCACTCAGGTCCATGGTCCAGGCAGGGTCCATGGTCCAAGGGCGGAGGTCCAACAGGTCCACGGTCCAGACGGTCCAGGTCCAGGTCCAGGGGTCCACGGTCCAGGTCCACGGTCCAGAGGTCCAGGTCCAGGGTCCAACAGGGGGTCCAGGGAAAACGGGGTCCAGGTCCAACGGTCCATGGTCCATTGACCTTAGGTCCAATGGATCATGGGTCCATCGGGTCCAGGTCCAGGGGTCCAGGTCCAATTTGTACCGCGGTCCAGGTCCAACCACGGGTCCATGGCCGGGGTCCACACGGTCCACCGCGATACTTTCGGTCCAGGTCCAGGTCCACGCCGGTCCAAGGTCCAGGTCCAGTCCCCTCGGGGTCCAGGTCCAGAAGGTCCATAGGTCCAGGTCCAGTTATCGGTCCAGGTCCAGGTCCACAGGTCCACTGGTCCAGTAACTGCTGCGGTCCAGGTCCAGGTCCAGCAAAGGTCCATTGGTCCAGGTCCATCGGTCCATCGTGAGGTCCAGGTCCAGCGGTCCAGGTCCAGAGGTCCAGGTCCATGGTCCAATCTTCGGTCCAGGTCCACCGGGTCCACAGGTCCAGGGTCCAGGTCCAGAGGTCCATCTAACGGTCCAACCGGTCCAGGTCCAGGTCCAGGTCCAGGTCCACACTTGGTCCAAGTTCGGTCCAATGGTCCATATAAGGTCCACGAGATGAAAGGTCCAAGGTCCATGGTCCAGGTCCAGGTCCACGGTCCAGGTCCAAGTCGGTCCAGAGGTCCAGAGGTCCATCGGGTCCATTCGGTCCATTGGTCCATGAAGGTCCATGGTCCATGGTCCAGTCCGGTCCAGGTCCAGGTCCAGGGTCCATGGTCCACGGTCCACCTAGGTCCAGTGTACGGGCGGGGTCCAAACAGCGGTCCATGGAGGTCCAGGTCCACGGAATGGGTCCAGCGGTCCAGTGGTCCAGGTCCAGGTCCAGGATGGTCCAGAGCACCGGTCCAGTACACCGGTCCACTGCGCAGGTCCACGGCTGGTCCAGGTCCAGGTCCATGAGGTCCAGGCGGTCCAGGGTCCATGAAGGTCCAAGTTCATAGGTCCAGGTCCAGGTCCAAGGTCCAAGGTCCAGGTCCACCGGGTCCATTTGCTGGTCCAAGGTCCACGGGTCCAGCCAGAAGGTCCACGGTCCACGGTCCAGGTCCAAGGTCCAGGTCCAGGTCCATCTGAAAGGGGTCCATATCTTGGGTCCAGGTCCAGGTCCATAGGTCCACGGTCCAGAGAGGTCCAGGTAGAGGTCCACCGGTCCATCTGGTCCAGGTCCAGAGCCTTAGGTCCAGGGGTCCAGGTCCAGGTCCAGGTCCACGAGGGTCCAGTAGGTCCAAAGGTCCAACCGCGGTCCAATTCTGGTCCAAAGGTCCAGGGTCCAGCGGTCCAGACGGTCCATAGCCAGGTCCACGGTCCAGGTCCATAAATGTTGGTCCAAGAACTTGGTCCAGCCATGGGTCCACCATCATGGTCCATTAGCATGCAACAAGGTCCAGGTCCAGGTCCAGGTCCAGGTCCAGCTGGGTCCAAGGGTCCAGGTCCAGGGTCCACGGGTCCACCGAGCGGTCCAGGTCCAGGTCCATTGGGTCCAGAGGCCAGGTCCAAACGGTCCATCTAATATGGTCCACTGCTAGAGGTCCAGCGGTCCAAGTCGGTCCAGTTGGGTCCAGGTCCAATGAATGTTGTAGAAGGCGGTCCAGGTCCACGCAACTGGGGGCGGGTCCAGGCAGATTGTAACGGTCCAGGTCCAGGTCCAGGTCCATGCCCGTCGGGTCCATGATAGGTCCAGGTCCAAACGGTCCAGATTACCTTGGTCCAGGTCCAGGTCCATGGTCCAGGTCCAAATAAGGTCCAGGTCCAGGTCCACAGGGACGCAGGTCCAGGGTCCAGGTCCATGCGGTCCATCGCGGTCCACGGTCCAGCAGGGGTCCAAAATCCGGTCCAGGTCCAATCGTCTGGGTCCAGGGTCCAGGGTCCAGGTCCACACTGGTCCACCCAGGTCCATGGTCCAAGGTCCACTGGTCCAGGTCCATAAGAGGGTCCATTGTCTGGTCCAGCGGTCCAGGTCCAGGGTCCAGAGGGTCCACTTCTTGGGTCCAGGTCCAATGGTCCAGGTCCAAGGGTCCAGGTCCAGGTCCAGGTCCAGCGGTCCAAGGGTCCATAAGGTCCATTGGGTCCATCTGGGTCCAACCTTGGTCCAGGTCCAGGTCCACGGTCCAGGTCCAATGCGGTCCAGGTCCAGGTCCACTACTACTTGGTCCACGGTCCAAAGCGGTCCAAGGTCCAGCCTCACGACTTTTCGGTCCAGGGTCCAGGTCCAACCTGGTCCACCGGTCCAGTGGTCCAGCAGGGTCCATGGTGGGTCCATTGGTCCAGTTGTCGGGTCCAGGTCCAACGCGGTCCAGGTCCAGGTCCATGGGTCCACCCAGGTCCAGGGTCCATATGGTCCAAAGGGTCCAATGGTCCATGGTCCATGGTCCAACCACAGGGTCCATAGGTCCAGGTCCAGAAAGGTCCATTGGTCCAAGGTCCATGGTCCAAGGGTCCATCCAGGGTCCAGGGTCCAACGGTCCAAGGGTCCATTATTGGTCCAGTGGTCGGTCCAACGGTCCAGGTCCAGATAGGTCCAGGTCCAGGTCCAGGTCCAGGGTCCAGGTCCAGGTCCAGGTAAGGTCCACTAGGTCCAGGTCCAACGGTCCAGGTCCAGGTCCAGGTCCAGTGGTCCAGGTCCAAGGGTCCAAGGTCCAAGGTCCACTGGGTCCAGGGGTCCACTGGGTCCAGGGGCCCGGTCCACGGGTCCACCCTTGAGGTCCAGGGTCCAGATGGTCCAGCGGTCCAGGTCCAGGTCCATGGTCCAGGTCCATGGGTCCAACGGTCCAGGCTCTGGTCCAGGGTCCAGGTCCACGGTCCAGGTCCACTTCGGTCCATGACCTGTGGTCCATGCGGTCCAAGGTCCAGGTCCAGGTCCAGGTCCATTTTGGGTCCATGGTCCCGGGGCCCTTGGGTCCACACGGTCCACGGTCCAGGTCCAATTTGGTCCAGGTCCACGGGTCCACGGGTCCAGCAAGGTCCATAGGTCCAGCGGTCCATGGTCCACTGGTCCAGGGCCTAGACTGTATTAGGTCCACGGTCCAGGTCCATGTCGGGTCCAAGGTCCAATACTAAGGTCCACGGTCCAGAGGTCCAGGTCCACGGTCCATTTTTAAGGGTCCAAACCCTGGTCCATGGTCCACCGGGTCCAGGTCCAGGTCCATATGGTCCATGGTCCAAAAAGTGAGAGGTGGTCCAGAGGGTCCAATCAGGTCCACATCCTGGTCCATGTAGCGTGGGGTCCAGAGGTCCATTCGGGTCCAGGTCCAGGATGGTCCAGGTCCACAGAGGTCCAACGGGGGTCCAAGGGGTCCACATGGTAGGTCCAATAGGTCCAGGTCCACGGTCCAGGTCCACCCGGTCCAGGTCCATGAAATAACATGGTCCAAACGGGTCCACCGGTCCAGGTCCAAAATGGTCCAGTTCTATTCGGTCCAGGGGTCCATTGCGGGGTCCAGTGCACGGTCCAGGTCCAGGTCCATGGTCCATGGTCCAGAGGTCCATGAGGTCCACGGTCCACATGGTCCATGGTCCAAGGTCCACGGTCCATAGGTCCAGAGAGGTCCAGGGCGGTCCAGGTCCAGGGTCCAGGCGGTCCACGGTCCATAGGTCCAGGTCCATACTGTGTTTGTGGGTCCAAGGTCCATTGGTCCATATGGTCCAGGTCCAAGGTCCAGCGGTCCACGGGGTCCATCGGGTCCATGGTCCATTCGCGGTCCAAGTAGAGTCGGTCCAAGGTCCAGGTCCAGGTCCACGGTCCAGGTCCATCGGTCCAGCAGGTCCATGATAGGGGTCCAGCAGCCGGTCCAGCGAGGGGGTCCATATTATTGGTCCAGGTCCAGGTCCAAAGGGTCCACGGGCAGGGTCCAGTAGGTCCATTTAAAGGTCCACGGGTCCAGGTCCATTTAGACCGGTCCATGGTCCAGGTCCAACCGGTCCACTTTAGGTCCATGGGTCCACGGTCCAGGTCCAGGTCCATGCCACCGGTCCAGGTCCAGGTCCAGGCATCAAGGTCCACTGGTCCATTACTGAAAGGGTCCAAGACCGGTCCATGGCCGGTCCAGGGCCGGGTCCAGGTCCAGGTCCAGGTCCATCCGGTCCAGGGTCCAACGGTCCAAGGGTCCACGGTTTGGTCCAGGTCCACAACGGTCCATAACGTCTCCGGTCCAGAAGGTCCAGAGGTCCAGGTCCAATCGGTCCAATACGAGCTGGGTCCAAATGGTCCAGGTCCAGGTCCAGGTCCATTCGGGGTCCAGGTCCATCGTGGTCCATTAGGCGGGTCCAGGTCCACCGGTCCAGTGGTCCAGGTCCAAGGTCCAATGGTCCAGGGTCCAGCCAGGGTCCATTGGTCCAGCGGTCCAAGTGGTCCAGGTCCAGGTCCATAGGTCCAGGGTCCAAAGGTCCAGGTCCAACTGAGTAGGTCCAGGGTGGTCCAGCGAGGTCCAGGTCCACGAAATGGTCCAGGTCCAGGTCCAGGGGTCCATTTGCGGTCCACGAGTGGTCGGTCCAGGTCCATTTGTCGGTCCACAGGTCCAGACGGTCCAAAGGTCCATCGGTCCAAGGTCCAATCAGGTCCAGCGGTCCAGGTCCACGGGTCCAGGTCCAACGGTCCAGGGGTCCAGCCGAGAGGTCCATTGCTTGGTCCAAGGGTCCATCGGGGTCCAGGTCCAGGTCCAGGTCCAGGTCCAAGGTGGTCCAAAAACGGGGTCCAGGTCCAGGTCCAGGTCCACTTTAGGTCCACGGTCCATAGGTCCAAGGTCCAGGTCCAGGGTCCAGACCGGACGGTCCAAGGTCCAGGTGTATCCCTGGTCCAACGGGGTCCAGGTCCAACGGGGTCCATAGGTCCATGGTTGCCGACTGGTCCACCCGGTCCATGGTCCAAGCGGGTGGGTCCAGATTGGTCCACTGGTCCATGGTCCATAGGTCCAGGGGTGGTCCATGGTCCATGCAAGTGGTCCAAAGGTCCAATCGTAGGGGGGTCCAGGTCCAGTGTAGGTCCAGGTCCAGGTCCAGGTCCAAACGGTCCACGTGGTCCAGGTCCACAAAGGGTCCAGGGGAGGTCCAGGGGTCCATCTTAGTCGGTCCAAAGGGGTCCAGGTCCATTCTGGGTCCATCCATGGTCCAGGTCCACGATAGGTCCAGGGTCCACGGTCCAGCCGTGGTCCAACGAGGTCCAAATCGGTCCACGGTCCAGGGTCCAAGGTCCAAGTGAGTAGGGGTCCATGTTAGACCTATAATTGGTCCAGGTCCACTCGGGTTGCGTACTTTGGTCCAGGTCCAGGTCCAACTGGTCCAAGGTCCACGGGTCCACCATGTTTTGGGTCCAGGTCCAGGTGGTCCAGGTCCATTGGTGGGGATAGGTCCAGGTCCATAAGGTCCATGGGGTCCAAGGTCCAGGGTCCAGGTCCATGCTGGGTCCATCCTATCGAAGGTCCACTGGTCCACAATCTGGTTGGTCCAGGTCCAGGTCCAGGTCCAAGGTCCAGGGTCCACCCGGTCCAGGTCCAGGTCCATGGGTCCAACGGTCCACTGCGGTCCACCGGGGTCCACGATGCCTTGGTCCATGGTCCATACGGGGGTCCAGCGATGGTCCAACCGGGTCCATTACAGGTCCAGATAGGTCCAACGGTCCAATGCCTTGGTCCATCAGGTCCAAATCCTAGTGGTCCACGGGTGGTCCAGAGTGGTCCATGGTCCAAGTTGGTCCAGGTCCAGGTCCACTCTCGGCCCCGGTCCACGGTCCATGCGCGGTCCAACCGGTCCATTGGTCCAGCCCTGAGGGTCCAAGGGTCCAAGGTCCACTAGGTCCAGGTCCAGGGGTCCAGGTCCAGGTCCACGGTCCATCGGTCCAAAGGTCCATGGTCCACACGGGTCCACAGGTCCACGGTCCAGGTCCATCTGGTCCAACGATACGCCGGGTCCAAGGTCCAGGTCCAGGGTCCACACCGTGGTCCATTCCCGGTCCAGGTCCAGGGTCCAGTACGGTCCAGGTCCATGGTCCAGTCGGTCCACACAATGGTCCAGGTCCATTGGTCCACGTGTGGGAGGGTCCA"
matches <- patternMatch(string, pattern, 0)
cat(matches)
